<Page xmlns="http://schemas.nativescript.org/tns.xsd" navigatingTo="navigatingTo" loaded="{{ onViewLoaded }}">
    <ActionBar title="Settings" backgroundColor="GreenYellow">
        <ActionItem
                icon="font://&#xe5cd;"
                tap="onCloseModal"
                android.position="actionBar"
                class="mdi-ro action-item"
        />
    </ActionBar>

    <StackLayout orientation="vertical">
        <StackLayout orientation="vertical" style="padding: 20">
            <FlexboxLayout justifyContent="center" alignItems="center">
                <Label text="Available models" class="label-title"/>
                <Label text="&#xe863;" class="mdi-ro" style="font-size: 40; margin-left: 10" tap="{{ onRefreshModelsTap }}"/>
            </FlexboxLayout>

            <Label visibility="{{ availableModels.length === 0 ? 'visible' : 'collapsed' }}" class="label-header"
                   text="No models available. Check your internet connection and tap refresh icon to download models" />
            <Repeater visibility="{{ availableModels.length !== 0 ? 'visible' : 'collapsed'}}"
                      id="repeater" items="{{ availableModels }}" >
                <Repeater.itemsLayout>
                    <StackLayout orientation="vertical"/>
                </Repeater.itemsLayout>
                <Repeater.itemTemplate>
                    <StackLayout>
                        <Label text="{{ $value.dataSource }}" class="label-header"/>
                        <Repeater items="{{ $value.info }}">
                            <Repeater.itemsLayout>
                                <StackLayout orientation="vertical"/>
                            </Repeater.itemsLayout>
                            <Repeater.itemTemplate>
                                <GridLayout id="{{ $value.model.name }}" rows="3*,2*,2*" columns="*,*" class="simple-card model margin-bottom" tap="{{ $value.vm.modelSelected }}">
                                    <Label row="0" col="0" colSpan="2" text="{{ $value.model.name }}" class="label-header bold"/>
                                    <Label row="1" col="0">
                                        <FormattedString>
                                            <Span text="Architecture: "/>
                                            <Span text="{{ $value.type }}"/>
                                        </FormattedString>
                                    </Label>
                                    <Label row="1" col="1">
                                        <FormattedString>
                                            <Span text="Version: "/>
                                            <Span text="{{ $value.model.version }}"/>
                                        </FormattedString>
                                    </Label>
                                    <Label row="2" col="0">
                                        <FormattedString>
                                            <Span text="Author: "/>
                                            <Span text="{{ $value.model.author }}"/>
                                        </FormattedString>
                                    </Label>
                                </GridLayout>
                            </Repeater.itemTemplate>
                        </Repeater>
                    </StackLayout>
                </Repeater.itemTemplate>
            </Repeater>
        </StackLayout>

        <Label style="background-color: black; width:100%; height:2px"/>

        <StackLayout orientation="vertical" style="padding: 20">
            <Label text="Delegates" class="label-title"/>
            <FlexboxLayout visibility="{{ gpuDelegate.supported ? 'visible' : 'collapsed' }}"
                           justifyContent="space-around" alignItems="center">
                <Label text="GPU delegate" class="label-header"/>
                <Switch checked="{{ gpuDelegate.enabled }}" checkedChange="{{ onGpuDelegateChange }}"/>
            </FlexboxLayout>
            <Label visibility="{{ gpuDelegate.supported ? 'collapsed' : 'visible' }}"
                   text="GPU delegate not supported" class="label-header"/>
        </StackLayout>
    </StackLayout>
</Page>

